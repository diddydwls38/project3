var _root=G_TOP_DIR

/*#######################################################
#	파일명	:	/js/common.js						#
#	설	명		:	사이트 공통 자바스크립트 							#
#	작성자	:	박용길											#
#	회	사	:	온디자인												#
#	일	자	:	2011-07-25										#
#######################################################*/

//####  체크영역 ####/
// Null 체크
var _isNull = function(checkStr) {
	return checkStr == null ? true : false;
}
// 문자 찾기 TF
var _find = function(checkStr, regex) {
	var reg = new RegExp(regex);
	return reg.test(checkStr);
}
// 숫자 체크
var isInteger = function(checkStr) {
	if (isNull(checkStr)) {return false;}
	return !find(checkStr, "[^0-9]");
}
// 숫자 영문자 체크
var isAlphaInteger = function(checkStr) {
	if (isNull(checkStr)) {return false;}
	return !find(checkStr, "[^a-zA-Z0-9]");
}
// 한글 체크
var isHangul = function(checkStr) {
	if (isNull(checkStr)) {return false;}
	return !find(checkStr, "[^가-힣]");
}
// 숫자와 "." 체크
var isIntDot = function(checkStr) {
	if (isNull(checkStr)) {return false;}
	return !find(checkStr, "[^0-9.]");
}
// 전화번호형 숫자와 "-" 체크
var isIntDash = function(checkStr) {
	if (isNull(checkStr)) {return false;}
	return !find(checkStr, "[^0-9\-]");
}

//#### 공용 사용자 함수 ####/

//0. trim String 함수 정의 : 앞뒤 공백제거
String.prototype.trim = function(){
	return this.replace(/(^ *)|( *$)/g, ""); 
}

//1. String을 encode로 변환
String.prototype.en = function(){
	return encodeURIComponent(this);
}
//1. String을 decode로 변환
String.prototype.dn = function(){
	return decodeURIComponent(this);
}
//업로드 가능한 파일 종류 체크 [메세지 자동 출력됨]
/*
		if(!IsFile(엘리먼트id,체크확장자 idx)) return;
EX]	if(!IsFile('upfile',1)) return;
*/
var IsFile = function(objs,type) {
	var checkStr = document.getElementById(objs);
	var arr = ['hwp,doc,docx,xls,xlsx,ppt,pptx,pdf,txt',			//type is 0
					'gif,jpg,png',												//type is 1
					'zip',															//type is 2
					'hwp,doc,docx,xls,xlsx,ppt,pptx,pdf,txt,gif,jpg,png,zip'	 //type is 3
				];
	strUse = arr[type]
	if (checkStr.value != "") {
		var strs = new String(checkStr.value).toLowerCase();
		strs = strs.substring(strs.lastIndexOf(".") + 1);
		if (strUse.indexOf(strs) < 0) {
			alert("업로드 가능한 파일의 종류는 " + strUse + "입니다.");
			return false;
		} else {
			return true;
		}
	}else{
		return true;
	}
}

//form 체크 함수		[메세지 자동 출력됨]
/*
		if(!chkForm(엘리먼트id, alert용 메세지, input인지 select인지, 최소자리수)) return;
EX]	if(!chkForm('userid', '아이디를 ', 'input', '6')) return;
*/
var chkForm = function(objs,titles,types,minlens){
	var objs = document.getElementById(objs);

	var typesmsg = '';

	if(types=='input') typesmsg = ' 입력해';
	else if(types=='select') typesmsg = ' 선택해';

	if(objs.value==""){
		

		alert(titles+" "+typesmsg+" 주세요");
//		wrapWindowByMask2(titles+typesmsg+'주세요','')


		if(objs.type!="textarea"){
			objs.focus();
		}
		return false;
	}
	if(minlens!=0&&objs.value.length<minlens){
//		wrapWindowByMask2(titles+ " 최소 "+minlens+"자리 이상으로 기입해주세요.");
		alert(titles+ " 최소 "+minlens+"자리 이상으로 기입해주세요.");
		return false;
	}
	return true;
}

//체크폼 alert창으로 띄우기 20120202 by HO
var chkForm1 = function(objs,titles,types,minlens){
	var objs = document.getElementById(objs);

	var typesmsg = '';

	if(types=='input') typesmsg = ' 입력해';
	else if(types=='select') typesmsg = ' 선택해';

	if(objs.value==""){
		

//		alert(titles+" "+typesmsg+" 주세요");
		alert(titles+typesmsg+'주세요','')


		if(objs.type!="textarea"){
			objs.focus();
		}
		return false;
	}
	if(minlens!=0&&objs.value.length<minlens){
		alert(titles+ " 최소 "+minlens+"자리 이상으로 기입해주세요.");
		return false;
	}
	return true;
}

// 주민번호 체크 기능	 [메세지 자동 출력됨]
/*
		if(fnSSNCheck(엘리먼트id,엘리먼트id)) return;
EX]	if(!fnSSNCheck('files','files2')) return;
*/
var fnSSNCheck = function(fSSN,lSSN){
	var fsSSN = document.getElementById(fSSN).value;
	var laSSN = document.getElementById(lSSN).value;

	a = new Array(6);
	b = new Array(7);
	tot=0;
	c=0;
	for(i=1;i<7;i++) {
		a[i]=fsSSN.substring(i-1,i);
		b[i]=laSSN.substring(i-1,i);
		if(i<3)
			c=Number(b[i])*(i+7);
		else if(i>=3)
			c=Number(b[i])*((i+9)%10);
		
		tot = tot + Number(a[i])*(i+1) + c;
	}

	b[7]=laSSN.substring(6,7);
	
	if(Number(b[7]) != ((11-(tot%11))%10)){
//		wrapWindowByMask2("주민번호가 올바르지 않습니다. 다시 확인해 주세요.");
		alert("주민번호가 올바르지 않습니다. 다시 확인해 주세요.");
		return false;
	}
	return true;
}

//####  plugin 영역 ####/

//####  > flash 관련 ####/
function FlashLoad(src,wid,hei) {
	Flash = "<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' codebase='http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0' width='"+ wid +"' height='"+ hei +"'>";
	Flash += "<param name='movie' value='"+ src +"'>";
	Flash += "<param name='quality' value='high'>";
	Flash += "<param name='wmode' value='transparent'>";
	Flash += "<param name='menu' value='false'>";
	Flash += "<embed src='"+ src +"' quality='high' wmode='transparent' pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' width='"+ wid +"' height='"+ hei +"'></embed>"
	Flash += "</object>";

	//document.body.innerHTML = Flash;
	document.write(Flash);
	return;
}



function flashObject(file_name,flashVar,width,height){
  document.write('<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" width="' + width + '" height="' + height + '">');
  document.write('<param name="movie" value="' + file_name + '">');
  document.write('<param name=FlashVars value="' + flashVar + '">');
  document.write('<param name="quality" value="high">');
  document.write('<param name="bgcolor" value="#ffffff">');
  document.write('<param name="wmode" value="transparent">');
  document.write('<param name="allowScriptAccess" value="always">');

  document.write('<embed src="' + file_name +'" FlashVars="' + flashVar +'" width="' + width + '" height="' + height + '" quality="high" bgcolor="#ffffff" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" wmode="transparent" allowScriptAccess="always" allowNetworking="all"></embed>');
  document.write('</object>');
}


// flash(파일주소, 가로, 세로, 배경색, 윈도우모드, 변수, 경로)
function flash(url,w,h,bg,win,vars,base){
	var s=
	"<object classid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000' codebase='http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0' width='"+w+"' height='"+h+"' align='middle'>"+
	"<param name='allowScriptAccess' value='always' />"+
	"<param name='movie' value='"+url+"' />"+
	"<param name='wmode' value='"+win+"' />"+
	"<param name='menu' value='false' />"+
	"<param name='quality' value='high' />"+
	"<param name='FlashVars' value='"+vars+"' />"+
	"<param name='bgcolor' value='"+bg+"' />"+
	"<param name='base' value='"+base+"' />"+
	"<embed src='"+url+"' base='"+base+"' wmode='"+win+"' menu='false' quality='high' bgcolor='"+bg+"' width='"+w+"' height='"+h+"' align='middle' type='application/x-shockwave-flash' pluginspage='http://www.macromedia.com/go/getflashplayer' />"+
	"</object>";
	document.write(s);
}
// 플래시메뉴링크 //
// 메인메뉴 //
function menu1() { location.href = _root + "/menu/menu_front.php"; }
function menu2() { location.href = _root + "/store/store_front.php"; }
function menu3() { location.href = _root + "/event/event_front.php"; }
function menu4() { location.href = _root + "/droptop/droptop_front.php"; }
function menu5() { location.href = _root + "/service/service_front.php"; }

// 프론트메뉴 //
function front_menu1() { location.href = _root + "/menu/menu_recommend.php"; }
function front_menu2() { location.href = _root + "/menu/menu_list.php?vCate=1&vCate2=15&vCate3=21"; }
function front_menu3() { location.href = _root + "/menu/menu_list.php?vCate=2&vCate2=17&vCate3=24"; }
function front_menu4() { location.href = _root + "/menu/menu_list.php?vCate=3&vCate2=19&vCate3=35"; }

function front_store1() { location.href = _root + "/store/grandopen_list.php"; }
function front_store2() { location.href = _root + "/store/store_list.php"; }
function front_store3() { location.href = _root + "/store/store_global_list.php"; }

function front_event1() { location.href = _root + "/event/event_list.php"; }
function front_event2() { location.href = _root + "/event/event_winner_list.php"; }
function front_event3() { location.href = _root + "/event/event_store_list.php"; }

function front_tomntoms1() { location.href = _root + "/droptop/brand_info.php"; }
function front_tomntoms2() { location.href = _root + "/ci/ceo_info.php"; }
function front_tomntoms3() { location.href = _root + "/franchise/franchise_info.php"; }
function front_tomntoms4() { location.href = _root + "/droptop/notice_list.php"; }
function front_tomntoms5() { location.href = _root + "/droptop/pr_list.php"; }
function front_tomntoms6() { location.href = _root + "/recruit/recruit_list.php"; }

function front_service1() { location.href = _root + "/service/membership.php"; }
function front_service2() { location.href = _root + "/service/membercard.php"; }
function front_service3() { location.href = _root + "/service/giftcard.php"; }
function front_service4() { location.href = _root + "/service/newsletter.php"; }
function front_service5() { location.href = _root + "/service/sns_info.php"; }
function front_service6() { location.href = _root + "/service/cs_nomember.php"; }

// 서브메뉴 //
function menu1sub1() { location.href = _root + "/menu/menu_recommend.php"; }
function menu1sub2() { location.href = _root + "/menu/menu_list.php?vCate=1&vCate2=15&vCate3=21"; }
function menu1sub3() { location.href = _root + "/menu/menu_list.php?vCate=2&vCate2=17&vCate3=24"; }
function menu1sub4() { location.href = _root + "/menu/menu_list.php?vCate=3&vCate2=19&vCate3=35"; }
function menu1sub2three1() { location.href = _root + "/menu/menu_list.php?vCate=1&vCate2=15&vCate3=21"; }
function menu1sub2three2() { location.href = _root + "/menu/menu_list.php?vCate=1&vCate2=16&vCate3=26"; }
function menu1sub3three1() { location.href = _root + "/menu/menu_list.php?vCate=2&vCate2=17&vCate3=24"; }
function menu1sub3three2() { location.href = _root + "/menu/menu_list.php?vCate=2&vCate2=18&vCate3=33"; }
function menu1sub4three1() { location.href = _root + "/menu/menu_list.php?vCate=3&vCate2=19&vCate3=35"; }
function menu1sub4three2() { location.href = _root + "/menu/menu_list.php?vCate=3&vCate2=20&vCate3=37"; }

function menu2sub1() { location.href = _root + "/store/grandopen_list.php"; }
function menu2sub2() { location.href = _root + "/store/store_list.php"; }
function menu2sub3() { location.href = _root + "/store/store_global_list.php"; }

function menu3sub1() { location.href = _root + "/event/event_list.php"; }
function menu3sub2() { location.href = _root + "/event/event_winner_list.php"; }
function menu3sub3() { location.href = _root + "/event/event_store_list.php"; }

function menu4sub1() { location.href = _root + "/droptop/brand_info.php"; }
function menu4sub2() { location.href = _root + "/ci/ceo_info.php"; }
function menu4sub3() { location.href = _root + "/franchise/franchise_info.php"; }
function menu4sub4() { location.href = _root + "/droptop/notice_list.php"; }
function menu4sub5() { location.href = _root + "/droptop/pr_list.php"; }
function menu4sub6() { location.href = _root + "/recruit/recruit_list.php"; }

function menu5sub1() { location.href = _root + "/service/membership.php"; }
function menu5sub2() { location.href = _root + "/service/membercard.php"; }
function menu5sub3() { location.href = _root + "/service/giftcard.php"; }
function menu5sub4() { location.href = _root + "/service/newsletter.php"; }
function menu5sub5() { location.href = _root + "/service/sns_info.php"; }
function menu5sub6() { location.href = _root + "/service/cs_nomember.php"; }
// 플래시메뉴링크 //

//####  > popup 관련 ####/
var fnPopup = function(url,names,width,height,top,left,option){
	var state = "width="+width+",height="+height+",top="+top+",left="+left+",toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars="+option+",resizable=no";
	window.open(url,names,state);
}
//####  > popup 광고 관련 ####/



//####  ajax통신 ####/
/* 필수적으로 jquery-1.6.2.min.js 프레임웍을 loading해야 함.
// 이벤트 발생 함수 (리스너)
var go_checkAjax = function(){
	var id = document.getElementById('files').value;
	var arr = {
		url:'checkID.php?vID='+id,			//접속 URL 및 Param값
		methodType:'GET',						//통신 방식 GET/POST
		returnType:'text',							//결과값의 형태 xml / json / html / text
		callback:'callBack',
		debug:true									//debug용 속성, 사용안할 경우는 false로 설정
	}

	fnAjax(arr);
}

//ajax통신 후에 값을 처리하는 콜백 함수
var callBack = function(data){
	alert(data);
}
*/
var fnAjax = function(arr){
	$.ajax({
		type: arr['methodType'],				//GET / POST
		url: arr['url'],
		dataType: arr['returnType'],			// xml / json / html / text
		timeout: 6000,
		success: function(data, status) {
	//		callBack(data);
			var fn = arr['callback']+"('"+data+"')";
			if(arr['debug']){
				alert(fn);
				return;
			}
			eval(fn);
		},
		error: function (request, status, error) {
			alert("Error status : " + status);		
		}
	});    
}

var fnAjaxGetList = function(arr){
	$.ajax({
		type: arr['methodType'],				//GET / POST
		url: arr['url'],
		dataType: arr['returnType'],			// xml / json / html / text
		timeout: 6000,
		success: function(data, status) {
			callBackGetList(data);
//			var fn = arr['callback']+"('"+data+"')";
//			if(arr['debug']){
//				alert(fn);
//				return;
//			}
//			eval(fn);
		},
		error: function (request, status, error) {
			alert("Error status : " + status);		
		}
	});    
}


//	SNS 
function openSNS(openUrl){
	var winObj;
	winObj = window.open(openUrl,"sendSNSWin","_blank");
}

function sendSNS(media,URL,idx){
	
	var chkUID = document.getElementById('_f_UID').value;
	if(chkUID!=''){
		var path = "/inc/ajaxSNSReg.php?vUID="+chkUID+"&vType="+media;
		$.get(path,function(data){

		});
	}

	switch(media){

		case "fc":	 //페이스북
			sendUrl="http://www.facebook.com/sharer/sharer.php?u="+URL;openSNS(sendUrl);
			break;
		case "tw": //트위터
			sendUrl="http://twitter.com/intent/tweet?source=webclient&text="+URL;openSNS(sendUrl);
			break;
		case "me": //미투데이
			sendUrl="http://me2day.net/posts/new?new_post[body]=http://"+URL; openSNS(sendUrl);
			break;
		case "yo":	//요즘
			sendUrl="http://yozm.daum.net/api/popup/prePost?sourceid=41&link=http://125.141.234.180/menu/nnb/menu_nnb_detail.php?vIDX="+idx+"&prefix=CAFE DROPTOP";openSNS(sendUrl);
			break;
	}
}

function fnSNS(media,URL,idx){
	switch(media){

		case "fc":	 //페이스북
			sendUrl="http://www.facebook.com/sharer/sharer.php?u="+URL;openSNS(sendUrl);
			break;
		case "tw": //트위터
			sendUrl="http://twitter.com/intent/tweet?source=webclient&text="+URL;openSNS(sendUrl);
			break;
		case "me": //미투데이
			sendUrl="http://me2day.net/posts/new?new_post[body]=http://"+URL; openSNS(sendUrl);
			break;
		case "yo":	//요즘
			sendUrl="http://yozm.daum.net/api/popup/prePost?sourceid=41&link=http://cafedroptop.com/menu/nnb/menu_nnb_detail.php?vIDX="+idx+"&prefix=CAFE DROPTOP";openSNS(sendUrl);
			break;
	}
}


function goTwitter(msg,url) {
	var href = "http://twitter.com/share?url=" + encodeURIComponent(url) + "&text=" + encodeURIComponent(msg);
	var a = window.open(href, 'twitter', '');
	if ( a ) {
		a.focus();
	}
}

function goFaceBook(msg,url) {
	var href = "http://www.facebook.com/sharer.php?u=" + encodeURIComponent(url) + "&t=" + encodeURIComponent(msg);
	var a = window.open(href, 'facebook', '');
	if ( a ) {
		a.focus();
	}
}


//confirm 후 url 이동
function confirmAlert(msgType, url){

	if(msgType == "del"){
		msg = "정말 삭제 하시겠습니까?";
	}
	if(msgType == "buy"){
		msg = "정말 구매 하시겠습니까?";
	}
	
	if(confirm(msg)){
		location.href  = url;
	}

}


function winResize()
{
    var Dwidth = parseInt(document.body.scrollWidth);
    var Dheight = parseInt(document.body.scrollHeight);
    var divEl = document.createElement("div");
    divEl.style.position = "absolute";
    divEl.style.left = "0px";
    divEl.style.top = "0px";
    divEl.style.width = "100%";
    divEl.style.height = "100%";
 
    document.body.appendChild(divEl);
 
    window.resizeBy(Dwidth-divEl.offsetWidth, Dheight-divEl.offsetHeight);
    document.body.removeChild(divEl);
}


//더블클릭제어
var chkDbClick = function(){
	alert('더블클릭은 허용되지않습니다');
	return;
}


/********************************************************************************************************
모바일 여부
********************************************************************************************************/
function cookieVal(cookieName){
	thisCookie = document.cookie.split("; ");
	for(i=0; i<thisCookie.length; i++)	{
		if(cookieName == thisCookie[i].split("=")[0]){
			return thisCookie[i].split("=")[1];
		}
	}
	return "x";
}
//[오늘 하루 이창을 열지 않음]에 대한 쿠키 생성 함수
function setCookie( name, value, expiredays ){
	var todayDate = new Date();
	todayDate.setDate( todayDate.getDate() + expiredays );
	document.cookie = name + "=" + escape( value ) + "; path=/; expires=" + todayDate.toGMTString() + ";";
}

var mobileKind = "ETC";
var isMobile = false;
var uAgent = window.navigator.userAgent.toLowerCase();
var mobilePhones = new Array('iphone', 'ipod', 'blackberry', 'android', 'windows ce', 'windows ce;', 'lg', 'mot', 'samsung', 'sonyericsson', 'mobile', 'symbian', 'opera mobi', 'opera mini', 'iemobile');
/*
if(document.referrer.indexOf("http://m.tomntoms.com/") != -1){
	setCookie( "mobileChk", "isMobile" , 1 );// 숫자(날짜)변경 하루동안
}else{
	for(var i=0; i < mobilePhones.length; i++){
		if(uAgent.indexOf(mobilePhones[i]) != -1){
			setCookie( "mobileChk", "isMobile" , -1 );// 숫자(날짜)변경 하루동안
		}
	}
}

if(cookieVal("mobileChk") != "isMobile"){	//모바일 아니면
	for(var i=0; i < mobilePhones.length; i++){
		if(uAgent.indexOf(mobilePhones[i]) != -1){
			mobileKind = mobilePhones[i];
			isMobile = true;
			location.replace  ("http://m.tomntoms.com/mobile/main.php");
			break;
		} else {
			isMobile = false;
		}
	}
}
*/